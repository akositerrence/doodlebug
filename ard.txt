/*
 */

volatile unsigned long pulseCount = 0;
unsigned long lastTime = 0;

const int flowPin = 2;
const int pressurePin = A0;

void setup() {
  Serial.begin(9600);
  pinMode(flowPin, INPUT_PULLUP);
  attachInterrupt(digitalPinToInterrupt(flowPin), countPulse, FALLING);
}

void loop() {
  unsigned long now = millis();
  if( now - lastTime >= 1000 ) {
    noInterrupts();
    unsigned long pulses = pulseCount;
    pulseCount = 0;
    interrupts();

    int rawPressure = analogRead(pressurePin);
    Serial.print(pulses);
    Serial.print(rawPressure);

    lastTime = now;
  }
    
}

void countPulse() {
  pulseCount++;
}